(function(e){e.fn.html5audio=function(g){function d(){var a=0==f.find("div[class='fontMeasure']").length?e("<div/>").addClass("fontMeasure").appendTo(f):f.find("div[class='fontMeasure']");Y=new apTextScroller;Y.init(a,Qa,rd,"left",g.scrollSeparator,g.scrollSpeed)}function M(){E&&clearTimeout(E);N.css("display","none");lb=!1}function Ea(a){if(m&&!p&&!ea){if(!mb){if("touchstart"==a.type){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();mb=!0;qa.on(Ra,function(a){a:{if("touchmove"==
a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)var b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a;if(1<b.length)break a;b=b[0]}else b=a.originalEvent;a.preventDefault();J(b)}}).on(Sa,function(a){a:if(mb){mb=!1;qa.off(Ra).off(Sa);if("touchend"==a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)var b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&
a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a;if(1<b.length)break a;b=b[0]}else b=a.originalEvent;a.preventDefault();J(b)}})}return!1}}function J(a){"horizontal"==nb?v=Math.max(0,Math.min(1,(a.pageX-Ta.offset().left)/O)):(v=Math.max(0,Math.min(1,(a.pageY-Ta.offset().top)/O)),v=1-v);fa()}function H(){if(!m||p)return!1;Hb?(v=Yb,Hb=!1):(Yb=v,v=0,Hb=!0)}function fa(){"horizontal"==nb?Ib.css("width",v*O+"px"):Ib.css("height",v*O+"px");U&&h&&(h.volume=v);0<v?f.find(".player_volume").find("img").attr("src",
Ec):f.find(".player_volume").find("img").attr("src",Fc);isMobile&&ob&&(E&&clearTimeout(E),E=setTimeout(M,Jb))}function ra(){ob&&E&&clearTimeout(E);ha.css("display","block");N.on("mousemove",Ua).on("mouseout",P);qa.on("mouseout",P)}function P(){ob&&(E&&clearTimeout(E),E=setTimeout(M,Jb));ha.css("display","none");N.off("mousemove",Ua).off("mouseout",P);qa.off("mouseout",P)}function Ua(a){if("horizontal"==nb){var b=a.pageX-Ta.offset().left;if(!y(b))return!1;0>b?b=0:b>O&&(b=O);a=parseInt(a.pageX-N.offset().left-
ha.width()/2,10);ha.css("left",a+"px");b=Math.max(0,Math.min(1,b/O));b=parseInt(100*b,10)}else{b=a.pageY-Ta.offset().top;if(!y(b))return!1;0>b?b=0:b>O&&(b=O);a=parseInt(b-ha.height()/2,10);ha.css("top",a+sd+"px");b=Math.max(0,Math.min(1,b/O));b=parseInt(100*(1-b),10)}ha.find("p").html(b+" %")}function Va(a){if(m&&!p&&U&&!mb&&!Gc){if(!ea){if("touchstart"==a.type){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();ea=!0;qa.on(Ra,function(a){a:{if("touchmove"==a.type){if(a.originalEvent.touches&&
a.originalEvent.touches.length)var b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a;if(1<b.length)break a;b=b[0]}else b=a;a.preventDefault();Wa(b,a)}}).on(Sa,function(a){a:if(ea){ea=!1;qa.off(Ra).off(Sa);if("touchend"==a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)var b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;
else break a;if(1<b.length)break a;b=b[0]}else b=a;a.preventDefault();Wa(b,a)}})}return!1}}function Wa(a,b){if(!ia){Fa=a.pageX-Kb.offset().left;0>Fa?Fa=0:Fa>V&&(Fa=V);Ga.width(Fa);var c=Math.max(0,Math.min(1,Fa/V))}else if(ja){if(Zb(b)){if(Lb||$b>ac-Hc)return!1;ea||(pb(!0),z.clearRect(0,0,K,Q),Xa(ka),Ya());return!1}if(!Lb)return!1;c=a.pageX-la.offset().left-K/2;var k=a.pageY-la.offset().top-Q/2;c=Math.atan2(k,c);c>-1*Math.PI&&c<-.5*Math.PI&&(c=2*Math.PI+c);ka=c=Math.max(0,Math.min((c+Math.PI/2)/2*
Math.PI*10))/100;z.clearRect(0,0,K,Q);Xa(ka);Ya()}if(!y(c))return!1;qb=ka;h&&h.seekable&&0<h.seekable.length&&(!td||isMobile?h.currentTime=c*h.duration:c*h.duration>=h.buffered.end(0)-5?h.currentTime=h.buffered.end(0)-5:h.currentTime=c*h.duration)}function sa(){U&&(ma.css("display","block"),za.on("mousemove",Ic).on("mouseout",Ha),qa.on("mouseout",Ha))}function Ha(){U&&(ma.css("display","none"),za.off("mousemove",Ic).off("mouseout",Ha),qa.off("mouseout",Ha))}function Ic(a){if(!ia){var b=a.pageX-Kb.offset().left;
if(!y(b))return!1;0>b?b=0:b>V&&(b=V);a=parseInt(a.pageX-za.offset().left-ma.width()/2,10);ma.css("left",a+"px");b=Math.max(0,Math.min(1,b/V))}else if(ja){if(Zb(a))return ma.css("display","none"),!1;b=a.pageX-la.offset().left;a=a.pageY-la.offset().top;a=Math.atan2(a-Q/2,b-K/2);a>-1*Math.PI&&a<-.5*Math.PI&&(a=2*Math.PI+a);b=Math.max(0,Math.min((a+Math.PI/2)/2*Math.PI*10))/100;ma.css("display","block")}if(!y(b))return!1;a=b;if(y(a)){if(h){var c=h.duration;var k=a*c}y(k)&&y(c)&&ma.find("p").html(Jc(k)+
Kc+Lc(c))}}function Xa(a){z.beginPath();z.arc(K/2,Q/2,bc-rb/2,-Mb,Mc*a-Mb,!1);z.strokeStyle=cc;z.lineCap="butt";z.lineWidth=rb;z.stroke()}function Ya(){if(A)a=62,b=57,z.fillStyle=cc,z.fillRect(a,b,14,45),z.fillRect(a+23,b,14,45);else{var a=65,b=57,c=65-a,k=102-b,e=Math.atan2(k,c)-Math.PI/3;k=Math.sqrt(c*c+k*k);c=Math.cos(e)*k+a;e=Math.sin(e)*k+b;z.beginPath();z.fillStyle=cc;z.moveTo(a,b);z.lineTo(65,102);z.lineTo(c,e);z.fill()}}function Zb(a){if("touchstart"==a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)a=
a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)a=a.originalEvent.changedTouches;else return!1;if(1<a.length)return!1;var b=a[0]}else b=a.originalEvent;a=b.pageX-la.offset().left;b=b.pageY-la.offset().top;var c=K/2,k=Q/2;$b=Math.sqrt((a-c)*(a-c)+(b-k)*(b-k));return Math.sqrt((a-c)*(a-c)+(b-k)*(b-k))<ac}function ec(a){if(0!=f.find(".componentPlaylist").length)if(F)"vertical"==sb?na.outerHeight(!0)>=Za.height()?(F.reinitialise(),a&&(F.scrollToY(0),
e(".jspPane").css("top","0px"))):(F.destroy(),F=null):(F.reinitialise(),a&&(F.scrollToX(0),e(".jspPane").css("left","0px")));else if(a=f.find(".componentPlaylist"),F=a.jScrollPane().data().jsp,a.on("jsp-initialised",function(a,c){}).jScrollPane({mouseWheelSpeed:20}),"horizontal"==sb&&!isMobile)a.on("mousewheel",ud)}function ud(a,b,c,k){if(!m||p)return!1;F&&F.scrollByX(100*(0<b?-1:1));return!1}function pb(a){A?(h&&h.pause(),A=!1,ta("off")):(h&&h.play(),A=!0,tb("off"));if(!a)return!1}function Nc(a){if(!m||
p)return!1;a.preventDefault();a=e(a.currentTarget);var b=a.attr("data-id");if(a.closest(".playlistItem").hasClass("playlist_locked"))return!1;R=!0;oa();l.processPlaylistRequest(b)}function vd(a){if(!m||p)return!1;a.preventDefault();a=e(a.currentTarget).attr("class").split(" ");if(-1!=e.inArray("controls_prev",a))R=!0,oa(),l.advanceHandler(-1,!0);else if(-1!=e.inArray("controls_toggle",a))U&&pb();else if(-1!=e.inArray("controls_next",a))R=!0,oa(),l.advanceHandler(1,!0);else if(-1!=e.inArray("player_volume",
a))isMobile?ob?(E&&clearTimeout(E),lb?(N.css("display","none"),lb=!1):(N.css("display","block"),lb=!0,E=setTimeout(M,Jb))):(H(),fa()):(H(),fa());else if(-1!=e.inArray("player_download",a)){if(!Nb&&!ua)if(a=$a){var b=l.getCounter(),c=u[b].download;b=fc(b,!1);a=Oc(a,b,c);Pc(a.name,a.path)}else r&&alert("Invalid data-type for file download function! Quitting."),ua=!1}else-1!=e.inArray("player_loop",a)?(Z?(f.find(".player_loop").find("img").attr("src",Ob),Z=!1):(f.find(".player_loop").find("img").attr("src",
ub),Z=!0),l.setLooping(Z)):-1!=e.inArray("player_shuffle",a)&&(aa?(f.find(".player_shuffle").find("img").attr("src",Pb),aa=!1):(f.find(".player_shuffle").find("img").attr("src",vb),aa=!0),l.setRandom(aa))}function wd(a){m&&(a.preventDefault(),a=e(a.currentTarget).attr("class").split(" "),-1!=e.inArray("controls_prev",a)?f.find(".controls_prev").find("img").attr("src",xd):-1!=e.inArray("controls_toggle",a)?A?tb("on"):ta("on"):-1!=e.inArray("controls_next",a)?f.find(".controls_next").find("img").attr("src",
yd):-1!=e.inArray("player_volume",a)?0<v?f.find(".player_volume").find("img").attr("src",zd):f.find(".player_volume").find("img").attr("src",Ad):-1!=e.inArray("player_download",a)?f.find(".player_download").find("img").attr("src",Bd):-1!=e.inArray("player_loop",a)?Z?f.find(".player_loop").find("img").attr("src",Ob):f.find(".player_loop").find("img").attr("src",ub):-1!=e.inArray("player_shuffle",a)&&(aa?f.find(".player_shuffle").find("img").attr("src",Pb):f.find(".player_shuffle").find("img").attr("src",
vb)))}function Cd(a){m&&(a.preventDefault(),a=e(a.currentTarget).attr("class").split(" "),-1!=e.inArray("controls_prev",a)?f.find(".controls_prev").find("img").attr("src",Dd):-1!=e.inArray("controls_toggle",a)?A?tb("off"):ta("off"):-1!=e.inArray("controls_next",a)?f.find(".controls_next").find("img").attr("src",Ed):-1!=e.inArray("player_volume",a)?0<v?f.find(".player_volume").find("img").attr("src",Ec):f.find(".player_volume").find("img").attr("src",Fc):-1!=e.inArray("player_download",a)?f.find(".player_download").find("img").attr("src",
Fd):-1!=e.inArray("player_loop",a)?Z?f.find(".player_loop").find("img").attr("src",ub):f.find(".player_loop").find("img").attr("src",Ob):-1!=e.inArray("player_shuffle",a)&&(aa?f.find(".player_shuffle").find("img").attr("src",vb):f.find(".player_shuffle").find("img").attr("src",Pb)))}function oa(){if(!W&&-1!=l.getCounter()){var a=e(va[l.getCounter()]);if(a&&a.hasClass("playlistSelected")){var b=a.attr("data-id");a.removeClass("playlistSelected").addClass("playlistNonSelected");"undefined"!==typeof playlistItemEnabled&&
playlistItemEnabled(B,G,a,b)}}}function Qc(){if(!W){var a=e(va[l.getCounter()]);if(a&&a.hasClass("playlistNonSelected")){var b=a.attr("data-id");a.removeClass("playlistNonSelected").addClass("playlistSelected");"undefined"!==typeof playlistItemDisabled&&playlistItemDisabled(B,G,a,b)}}}function gc(){var a=g.activeItem;y(a)&&-1!=a?(0>a?a=0:a>w-1&&(a=w-1),l.setCounter(a,!1)):R=!0}function Rc(){n&&-1!=l.getCounter()&&(wb(),Sc(),oa())}function xb(){wb();Sc();var a=0;for(a;a<w;a++){var b=e(va[a]).off("click",
Nc);Tc&&!isMobile&&b.off("mouseenter").off("mouseleave")}n&&(n.children().each(function(){var a=e(this);a.data("hap_wrap_player")&&a.data("hap_wrap_player").destroyPlaylist()}),n.empty(),n=null);na.empty();W=yb=!1;zb=L=q=null;ab=bb=Ab=!1;cb=null;l.reSetCounter();u=[];va=[];D=[];F&&F.reinitialise()}function wb(){Qb&&"hls"==$a&&Aa.detachMedia();wa&&clearInterval(wa);h&&(h.pause(),h.src="");Bb&&Bb.off("ended pause play canplay canplaythrough loadedmetadata error");hc();zb?Ia.css("display","block"):Ia.css("display",
"none");qb=null;ic=U=A=Gc=!1;jc||(Cb=void 0)}function Uc(a){if("undefined"===typeof a)return r&&alert("setPlaylist method requires data parameter. loadPlaylist failed."),!1;if("undefined"===typeof a.hidden)return r&&alert("setPlaylist method requires data.hidden parameter. loadPlaylist failed."),!1;var b=Gd(a.hidden);if("undefined"===typeof a.id)return r&&alert("setPlaylist method requires data.id parameter. loadPlaylist failed."),!1;a=a.id;p=!0;Vc||(Vc=!0);Wc();na.css("opacity",0);n&&(xb(),isMobile&&
(R=!1));yb=!1;W=b;Xc&&isIE?(b=e(Ba.find(a).css("display","block").clone().wrap("<p>").parent().html()),e(Ba.find(a).css("display","none"))):(b=Ba.find(a).css("display","block").clone(),Ba.find(a).css("display","none"));b.css("fontSize",0);if(0==b.length)return r&&alert('Failed to select playlist! Make sure that element: "'+a+'" exist in playlist list! Quitting.'),kc(),!1;if(W)db.empty(),b.appendTo(db),ba=0,ab=bb=Ja=!0,n=lc;else{if(!F&&0==na.length)return r&&alert("playlist_inner html element seems to be missing! You could be trying to use loadPlaylist method without having necessary html elements inside componentWrapper. Quitting."),
!1;b.appendTo(na);n=b}u=[];va=[];D=[];x=[];b.find("li[class*='playlistItem']").each(function(){x.push(e(this))});I()}function I(){x.length?Hd():Id()}function Hd(){Db=S=T=L=pa=null;mc=!1;var a=x[0],b=a.attr("data-type").toLowerCase(),c=a.attr("data-path"),k=a.hasClass("hap_processed");t=[];a.hasClass("hap_draggable")&&(mc=!0);void 0==a.attr("data-plink")||C(a.attr("data-plink"))||(pa=a.attr("data-plink"));void 0!=a.attr("data-dlink")&&(L=C(a.attr("data-dlink"))?!0:a.attr("data-dlink"));void 0!=a.attr("data-download")&&
(T=C(a.attr("data-download"))?!0:a.attr("data-download"));void 0==a.attr("data-thumb")||C(a.attr("data-thumb"))||(S=a.attr("data-thumb"));C(e.trim(a.html()))||(Db=a.html());if(k)q=a,x.shift(),I();else if("local"==b||"hls"==b)q=a,x.shift(),I();else if("soundcloud"==b)q=a.data("toremove","true"),Rb=0,Sb(c);else if("podcast"==b)q=a.data("toremove","true"),k=Jd+"?url="+encodeURIComponent(c),e.ajax({url:k,dataType:"json",cache:!1}).done(function(a){if(ieBelow9){a=Kd(a.contents);var b;k=0;e(a).find("item").each(function(){if(k==
nc)return!1;b=e(this);d={type:"podcast"};d.mp3=b.find("enclosure").attr("url");d.title=b.find("title").text();0<b.find("media\\:thumbnail").length?b.find("media\\:thumbnail").attr("url")?d.thumb=b.find("media\\:thumbnail").attr("url"):S&&(d.thumb=S):S&&(d.thumb=S);pa&&(d.url=pa);L&&(d.dlink=L);T&&(d.download=T);t.push(d);k++})}else{Yc.html(a.contents);a=Yc.get(0).getElementsByTagName("item");var c=0,k=a.length;k>nc&&(k=nc);for(c;c<k;c++){var f=a[c];if(void 0!=f.getElementsByTagName("enclosure")[0]){var d=
{type:"podcast"};d.mp3=f.getElementsByTagName("enclosure")[0].getAttribute("url");if(void 0!=f.getElementsByTagName("itunes:duration")[0]){var g=Ld(f.getElementsByTagName("itunes:duration")[0].childNodes[0].nodeValue);d.length=parseInt(1E3*g,10)}void 0!=f.getElementsByTagName("media:thumbnail")[0]?void 0!=f.getElementsByTagName("media:thumbnail")[0].getAttribute("url")?d.thumb=f.getElementsByTagName("media:thumbnail")[0].getAttribute("url"):S&&(d.thumb=S):S&&(d.thumb=S);d.title=f.getElementsByTagName("title")[0].childNodes[0].nodeValue;
pa&&(d.url=pa);L&&(d.dlink=L);T&&(d.download=T);t.push(d)}}}Ka()}).fail(function(a,b,k){r&&alert("Parse feed error: "+a.responseText);r&&alert("Playlist process failed, podcast: "+c);q&&"true"==q.data("toremove")&&q.remove();x.shift();I()});else if("folder"==b){q=a.data("toremove","true");k=hap_source_path+"folder_parser.php";var f=!0;void 0!=a.attr("data-subdirs")&&"false"==a.attr("data-subdirs")&&(f=!1);f={dir:c,subdirs:f};e.ajax({type:"GET",url:k,data:f,dataType:"json"}).done(function(a){Md(a,
"title");var b=0,c=a.length;Zc&&(Ca=t.length?t.length-1:0);for(b;b<c;b++){var k=a[b];var e=k.path;e=e.replace(/\\'/g,"'");e=e.replace(/\\"/g,'"');e=e.replace(/\\0/g,"\x00");path=e=e.replace(/\\\\/g,"\\");e={type:"folder"};if(/.mp3/.test(path)){e.mp3=path;var d=path.substr(0,path.lastIndexOf("."));title=/\//i.test(d)?d.substr(d.lastIndexOf("/")+1):d;title=title.split("_").join(" ");e.title=title;e.thumb=path.substr(0,path.lastIndexOf("."))+".jpg";e.size=parseInt(k.size,10);e.lastmod=parseInt(k.lastmod,
10);pa&&(e.url=pa);L&&(e.dlink=L);T&&(e.download=T);S&&(e.thumb=S);t.push(e)}}t.length&&Zc?$c():Ka()}).fail(function(a,b,k){r&&alert("Read folder error! Make sure you run this online or on local server!");r&&alert("Playlist process failed, folder: "+c);q&&"true"==q.data("toremove")&&q.remove();x.shift();I()})}else if("xml"==b){q=a;k=hap_source_path+c;var d,g=[];e.ajax({type:"GET",url:k,dataType:"html",cache:!1}).done(function(b){x.shift();e(b).find("li[class='playlistItem']").each(function(){d=oc(e(this));
q?q.after(e(d)):0<n.children().length?e(d).prependTo(n):e(d).appendTo(n);q=e(d);g.push(e(d))});b=0;var c=g.length;g.reverse();for(b;b<c;b++)x.unshift(g[b]);g=null;a.remove();I()}).fail(function(a,b,k){r&&alert("Playlist process failed, xml: "+c);q&&q.remove();x.shift();I()})}else if("database_data"==b||"database_html"==b)if(void 0==a.attr("data-table")||C(a.attr("data-table")))r&&(alert("Database table missing!"),alert("Playlist process failed, database query: "+c)),x.shift(),I();else{var h=f=null,
m=null;void 0==a.attr("data-limit")||C(a.attr("data-limit"))||(f=parseInt(a.attr("data-limit"),10));void 0==a.attr("data-range")||C(a.attr("data-range"))||(k=a.attr("data-range").split(","),2==k.length&&(h=k[0],m=k[1]));q=a;k=hap_source_path+"includes/database.php";g=[];f={db_name:c,db_table:a.attr("data-table"),db_type:b,limit:f,range_from:h,range_to:m};e.ajax({type:"POST",url:k,data:f}).done(function(k){if(-1<k.indexOf("Database information missing!")||-1<k.indexOf("Db connection failed")||-1<k.indexOf("Db selection failed")||
-1<k.indexOf("Db query failed"))r&&(alert(k),alert("Playlist process failed, database query: "+c)),q&&q.remove(),x.shift();else{x.shift();k=e.parseJSON(k);var f=0,dc=k.length;for(f;f<dc;f++){var h=k[f];if("database_data"==b)if(h.type&&h.mp3||h.path)d=ad(h);else continue;else if(h.path)d=oc(h.path);else continue;q?q.after(e(d)):0<n.children().length?e(d).prependTo(n):e(d).appendTo(n);q=e(d);g.push(e(d))}f=0;dc=g.length;g.reverse();for(f;f<dc;f++)x.unshift(g[f]);g=null;a.remove()}I()}).fail(function(a,
b,k){r&&alert("Playlist process failed, database query: "+c);q&&q.remove();x.shift();I()})}else r&&alert("Invalid playlist data-type attribute!"),x.shift(),I()}function Ka(){if(t.length){var a=0,b=t.length;for(a;a<b;a++){var c=t[a];var k=e('<li class="playlistItem" data-type="'+c.type+'"data-mp3="'+c.mp3+'" data-thumb="'+c.thumb+'"></li>');var f=c.mp3;/\.(mp3)$/i.test(c.mp3)||(f+=".mp3");mc&&k.addClass("hap_draggable");c.url&&k.attr("data-plink",c.url);c.dlink&&(1!=c.dlink&&"true"!=c.dlink?k.attr("data-dlink",
c.dlink):k.attr("data-dlink",f));c.download&&(1!=c.download&&"true"!=c.download?k.attr("data-download",c.download):k.attr("data-download",f));c.title&&k.attr("data-title",c.title);c.thumb&&("//"==c.thumb.substr(0,2)&&(c.thumb="http:"+c.thumb),k.attr("data-thumb",c.thumb));c.length&&k.attr("data-length",c.length);if("title"==xa)var d=e('<a class="playlistNonSelected" href="#">'+c.title+"</a>").appendTo(k);else"thumb"==xa?d=e('<a class="playlistNonSelected" href="#"><img src="'+c.thumb+'" alt="thumb"/></a>').appendTo(k):
"all"==xa&&(d=e('<a class="playlistNonSelected" href="#"></a>').appendTo(k),e('<span class="hap_thumb"><img src="'+c.thumb+'" alt="thumb"/></span>').appendTo(d),e('<span class="hap_title"><p>'+c.title+"</p></span>").appendTo(d));Db&&d.after(Db);q?(q.after(k),"true"==q.data("toremove")&&q.remove()):k.appendTo(n);q=k}}x.shift();I()}function Id(){if(Ab||bb){var a=0;q=null;var b;db.find("li[class*='playlistItem']").each(function(){b=e(this);q?q.after(b):Ja?b.appendTo(n):n.children().eq(ba).before(b);
q=b;a++});db.empty()}Tb();na.css("opacity",1);m||bd();Db=q=null;p=!1;kc();if(0<w){if(Ab||bb){var c=l.getCounter();l.setPlaylistItems(w,!1);ba<=c&&(Ja||l.reSetCounter(c+a));ab&&(ab=!1,gc())}else l.setPlaylistItems(w),gc();La&&ya()}bb=Ab=!1;0==w&&"undefined"!==typeof playlistEmpty&&playlistEmpty(B,G);"undefined"!==typeof audioPlayerPlaylistLoaded&&audioPlayerPlaylistLoaded(B,G);yb=!0}function Tb(){u=[];D=[];va=[];if(0==n.length)return r&&alert("lastPlaylist html element seems to be missing! You could be trying to use addTrack method without having necessary html elements inside componentWrapper. Quitting."),
!1;var a=0,b=n.find("li"),c=b.length,k,f,d,g;Eb=0;for(a;a<c;a++){var h=e(b[a]).addClass("hap_processed");D.push(h);pc&&h.addClass("playlist_locked");Eb="horizontal"==sb?Eb+h.outerWidth(!0):Eb+h.outerHeight(!0);var ca=h.find("a[class=playlistNonSelected]");0==ca.length&&(ca=h.find("a[class=playlistSelected]"));ca.off().on("click",Nc).attr("data-id",a);va.push(ca);if(Tc&&!isMobile)ca.on("mouseenter",function(a){if(!m||p)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&
a.stopPropagation();a=e(a.currentTarget).attr("data-id");var b=e(va[a]),c=!1;l.getCounter()==a&&(c=!0);"undefined"!==typeof playlistItemRollover&&playlistItemRollover(B,G,b,a,c);return!1}).on("mouseleave",function(a){if(!m||p)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=e(a.currentTarget).attr("data-id");var b=e(va[a]),c=!1;l.getCounter()==a&&(c=!0);"undefined"!==typeof playlistItemRollout&&playlistItemRollout(B,G,b,a,c);return!1});var q="";
void 0!=h.attr("data-title")?q=h.attr("data-title"):"title"==xa?q=ca.html():"thumb"!=xa&&"all"==xa&&(q=ca.find("span[class=hap_title]").find("p").html());if(qc){var t=rc(a)+sc+q;ca.html(t)}h=e(D[a]).attr({"data-id":a,"data-title":q});var M=t=k="";var v=void 0;var x=g=d=f=null;void 0!=h.attr("data-mp3")&&(k=h.attr("data-mp3"));void 0!=h.attr("data-type")&&(t=h.attr("data-type"));void 0!=h.attr("data-origtype")&&(M=h.attr("data-origtype"));void 0==h.attr("data-length")||C(h.attr("data-length"))||(v=
h.attr("data-length"));void 0!=h.attr("data-download")&&(d=C(h.attr("data-download"))||"true"==h.attr("data-download")?f=k:f=h.attr("data-download"));void 0!=h.attr("data-dlink")&&(d=C(h.attr("data-dlink"))||"true"==h.attr("data-dlink")?k:h.attr("data-dlink"));void 0==h.attr("data-plink")||C(h.attr("data-plink"))||(g=h.attr("data-plink"));void 0==h.attr("data-thumb")||C(h.attr("data-thumb"))||(x=h.attr("data-thumb"));W||(g&&0==h.find("a[class=plink]").length&&(g=e('<a class="plink" href="'+g+'" target="_blank"><img src="'+
cd+'" alt="purchase"/></a>'),ca.after(g)),d&&(Nb?0==h.find("a[class=dlink]").length&&(d=e('<a class="dlink" href="'+d+'" download><img src="'+tc+'" alt="download"/></a>'),ca.after(d)):0==h.find("a[class=dlink]").length&&(d=e('<a class="dlink" href="#" data-dlink="'+d+'"><img src="'+tc+'" alt="download"/></a>'),ca.after(d),C(h.attr("data-dlink")))),dd&&0==h.find("a[class=premove]").length&&(h=e('<a class="premove" href="#"><img src="'+Nd+'" alt="remove"/></a>'),ca.after(h)));u.push({id:a,type:t,origtype:M,
title:q,mp3:k,length:v,download:f,thumb:x})}b=null;w=u.length;W||(Od(),Pd&&Za.length&&!n.hasClass("ui-sortable")&&(n.on("sortstart",function(a,b){b.helper.css("margin-top",ed.scrollTop())}),n.on("sortbeforestop",function(a,b){b.helper.css("margin-top",0)}),n.sortable({cursor:"move",update:function(a,b){Tb();0<w&&l.setPlaylistItems(w);var c=na.find("a[class=playlistSelected]").attr("data-id");c&&(l.reSetCounter(c),La&&ya());1==w&&gc()},receive:function(a,b){"undefined"!==typeof dropReceive&&dropReceive(B,
G)}})),fd&&("horizontal"==sb&&na.width(Eb),ec(!0)));return!0}function bd(){m=!0;p=!1;kc();setTimeout(function(){gd();"horizontal"==nb?(O=Ta.width(),Ib.css("width",v*O+"px")):(O=Ta.height(),Ib.css("height",v*O+"px"));fa()},100);"undefined"!==typeof audioPlayerSetupDone&&audioPlayerSetupDone(B,G)}function Od(){var a=uc?eb:"click";if(Nb)f.find("a[class=dlink]").each(function(a){a=e(this);a.attr("href",a.attr("data-dlink")).attr("download","")});else f.find("a[class=dlink]").off().on(a,function(a){a.preventDefault();
if(ua)return!1;var b=e(this),k=b.closest(".playlistItem"),d=k.attr("data-id");if(k.hasClass("playlist_locked"))return!1;if(void 0==k.attr("data-type")||C(k.attr("data-type")))return r&&alert("Invalid data-type for file download function! Quitting."),ua=!1;a=k.attr("data-type");void 0==k.attr("data-origtype")||C(k.attr("data-origtype"))||(a=k.attr("data-origtype"));void 0==b.attr("data-dlink")||C(b.attr("data-dlink"))||(b=b.attr("data-dlink"),d=fc(d,!1),a=Oc(a,d,b),Pc(a.name,a.path))});f.find("a[class=plink]").off().on("click",
function(a){if(e(this).closest(".playlistItem").hasClass("playlist_locked"))return!1});if(dd)f.find("a[class=premove]").off().on("click",function(a){a.preventDefault();a=e(this).closest(".playlistItem");var b=parseInt(a.attr("data-id"),10);if(a.hasClass("playlist_locked"))return!1;B.removeTrack(b)})}function Oc(a,b,c){"local"==a||"folder"==a?(c.indexOf("\\")&&(c=c.replace(/\\/g,"/")),c.match(/^http([s]?):\/\/.*/)||(a=window.location.href,a=a.substr(0,a.lastIndexOf("/")+1),/^\.\.\//i.test(c)&&(c=c.substr(3),
"/"==a.charAt(a.length-1)&&(a=a.substr(0,a.lastIndexOf("/"))),a=a.substr(0,a.lastIndexOf("/")+1)),c=a+c),isMobile||(b=0<c.lastIndexOf("/")?c.substr(c.lastIndexOf("/")+1):c)):"soundcloud"==a&&(c=c.replace(/\/stream\\?/,"/download").replace(/\.mp3/,""));b=b.replace(/[^A-Z0-9\-_\.]+/ig,"_");/\.(mp3)$/i.test(b)||(b+=".mp3");return{name:b,path:c}}function Pc(a,b){if(isMobile)if(ua=!0,Qd)hd||(vc=id())&&(hd=!0),vc?jd(vc,a,b):ua=!1;else{var c=id();c?jd(c,a,b):ua=!1}else Rd.attr("src",hap_source_path+"dl.php?path="+
b+"&name="+a)}function jd(a,b,c){e.ajax({type:"POST",url:hap_source_path+"mail.php",data:"mail="+a+"&name="+b+"&path="+c}).done(function(a){ua=!1}).fail(function(a,b,c){r&&alert("Send email error: "+a.responseText);kd();ua=!1});Ub.css({marginTop:-Ub.height()/2+"px",display:"block"}).stop().animate({opacity:1},{duration:500});Fb&&clearTimeout(Fb);Fb=setTimeout(kd,Sd)}function kd(){Fb&&clearTimeout(Fb);Ub.stop().animate({opacity:0},{duration:500,complete:function(){Ub.css("display","none")}})}function id(){for(var a=
prompt("Please enter your email address where download link will be sent:"),b=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;(!b.test(a)||C(a))&&null!=a;)a=prompt("Please enter a valid email address:");return a}function Sb(a){if(C(wc))return alert("soundcloudApiKey has not been set! Skipping Soundcloud url."),x.shift(),I(),!1;/\/favorites$/.test(a)&&(a=a.replace(/\/favorites$/,"/likes"));var b=Td(a,wc);e.ajax({url:b,dataType:"jsonp",cache:!1}).done(function(b){var c;if(b.tracks){var d=b.tracks.length;d>X&&
(d=X);for(c=0;c<d;c++)b.tracks[c].streamable&&b.tracks[c].stream_url?t.push(xc(b.tracks[c])):(d+=1,d>b.tracks.length&&(d=b.tracks.length));t.length>X&&(t=t.slice(0,X));Ka()}else if(b.duration)b.permalink_url=a,b.streamable&&b.stream_url&&t.push(xc(b)),t.length>X&&(t=t.slice(0,X)),Ka();else if(b.username)/likes/.test(a)?(console.log("DATA.USERNAME.LIKES"),fb=b.uri+"/likes"):fb=/favorites/.test(a)?b.uri+"/favorites":b.uri+"/tracks",Sb(fb);else if(e.isArray(b)){d=b.length;d>X&&(d=X);for(c=0;c<d;c++)b[c].streamable&&
b[c].stream_url?t.push(xc(b[c])):(d+=1,d>b.length&&(d=b.length));50==d?(Rb+=50,Rb<X?Sb(fb):(t.length>X&&(t=t.slice(0,X)),Ka())):(t.length>X&&(t=t.slice(0,X)),Ka())}else b.kind&&"group"==b.kind?(fb=b.uri+"/tracks",Sb(fb)):(x.shift(),I())}).fail(function(b,d,e){r&&alert("Playlist process failed, soundcloud: "+a);x.shift();I()})}function xc(a){var b={type:"soundcloud"};a.duration&&(b.length=a.duration);b.mp3=a.stream_url+(/\?/.test(a.stream_url)?"&":"?")+"consumer_key="+wc;b.title=a.title;pa&&(b.url=
pa);a.downloadable&&a.download_url?(L&&(b.dlink=L),T&&(b.download=T)):(L&&1!=L&&"true"!=L&&(b.dlink=L),T&&1!=T&&"true"!=T&&(b.download=T));a.artwork_url?b.thumb=a.artwork_url:S&&(b.thumb=S);return b}function Td(a,b){return(/api\./.test(a)?a+"?":"http://api.soundcloud.com/resolve?url="+a+"&")+"format=json&offset="+Rb+"&consumer_key="+b+"&callback=?"}function $c(){var a=t[Ca].mp3+"?rand="+99999999*Math.random();ID3.loadTags(a,function(){var b=ID3.getAllTags(a);b.title&&(t[Ca].title=b.title);b.artist&&
(t[Ca].artist=b.artist);b.album&&(t[Ca].album=b.album);if(b=b.picture){var c="",d=0,e=b.data.length;for(d;d<e;d++)c+=String.fromCharCode(b.data[d]);t[Ca].thumb="data:"+b.format+";base64,"+window.btoa(c)}Ca++;Ca<t.length?$c():Ka()},{tags:["title","artist","album","picture"],onError:function(a){}})}function Ud(){var a=h.currentTime,b=h.duration;void 0!=h.buffered&&0!=h.buffered.length&&y(b)&&(Ma=h.buffered.end(0)/b);y(a)&&y(b)&&(Na&&Na.html(Jc(a)+Vb),Oa&&Oa.html(Lc(b)));if(ia)ja&&(y(Ma)&&(c=Ma,Da.beginPath(),
Da.arc(K/2,Q/2,bc-rb/2,-Mb,Mc*c-Mb,!1),Da.strokeStyle=Vd,Da.lineCap="butt",Da.lineWidth=rb,Da.stroke()),y(a)&&y(b)&&(ka=a/b,!ea&&A&&Xa(a/b)));else{if(y(Ma)){var c=Ma*V;c>V&&(c=V);gb&&gb.width(c)}y(a)&&y(b)&&!ea&&Ga&&Ga.width(a/b*V)}}function yc(){ld||(Bb=e(document.createElement("audio")).attr("preload",Wd),h=Bb[0],ld=!0);zc&&(h.src=Pa);Qb&&"hls"==$a?(Aa.attachMedia(h),R&&h.play()):R&&(h.load(),h.play());Bb.on("ended",function(a){"undefined"!==typeof audioPlayerSoundEnd&&audioPlayerSoundEnd(B,G,l.getCounter());
oa();l.advanceHandler(1,!0)}).on("pause",function(a){"undefined"!==typeof audioPlayerSoundPause&&audioPlayerSoundPause(B,G,l.getCounter())}).on("play",function(a){ic||("undefined"!==typeof audioPlayerSoundStart&&audioPlayerSoundStart(B,G,l.getCounter()),ic=!0);"undefined"!==typeof audioPlayerSoundPlay&&audioPlayerSoundPlay(B,G,l.getCounter());ia&&ja&&Ya()}).on("canplay",function(a){}).on("canplaythrough",function(a){}).on("loadedmetadata",function(a){h.volume=v;qb&&(h.seekable&&0<h.seekable.length&&
(h.currentTime=qb*h.duration),qb=null);wa&&clearInterval(wa);wa=setInterval(Ud,250)}).on("error",function(a){switch(h.error.code){case h.error.MEDIA_ERR_ABORTED:console.log("You aborted the audio playback.");break;case h.error.MEDIA_ERR_NETWORK:console.log("A network error caused the audio download to fail part-way.");break;case h.error.MEDIA_ERR_DECODE:console.log("The audio playback was aborted due to a corruption problem or because the audio used features your browser did not support.");break;
case h.error.MEDIA_ERR_SRC_NOT_SUPPORTED:console.log("The audio could not be loaded, either because the server or network failed or because the format is not supported.");break;default:console.log("An unknown error occurred.")}});R?(A=!0,tb("off")):(A=!1,ta("off"));R=U=!0}function gd(){if(!ia&&(V=Kb.width(),y(Ma)&&gb&&gb.width(Ma*V),!ea&&Ga)){if(h){var a=h.currentTime;var b=h.duration}try{a&&y(a)&&b&&y(b)&&Ga.width(a/b*V)}catch(c){}}fd&&!W&&ec();hb&&Y&&Y.checkSize()}function kc(){md.css("display",
"none")}function Wc(){md.css("display","block")}function Sc(){wa&&clearInterval(wa);hb&&Y&&Y.deactivate();Qa.html(Gb);Na.html(Ac+Vb);Oa.html(Bc);ia?ja&&(ka=0,z.clearRect(0,0,K,Q),Da.clearRect(0,0,K,Q)):(Ga.width(0),gb.width(0));ta("off");Ia.css("display","none")}function hc(){wa&&clearInterval(wa);La||(hb&&Y&&Y.deactivate(),Qa.html(Gb));Na.html(Ac+Vb);Oa.html(Bc);ia?ja&&(ka=0,z.clearRect(0,0,K,Q),Da.clearRect(0,0,K,Q)):(Ga.width(0),gb.width(0));ta("off");Ia.css("display","none")}function ta(a){"on"==
a?f.find(".controls_toggle").find("img").attr("src",Xd):f.find(".controls_toggle").find("img").attr("src",Yd);da&&da.hasClass("play_link")&&da.attr("src",Wb);ia&&ja&&(z.clearRect(0,0,K,Q),Xa(ka),Ya())}function tb(a){"on"==a?f.find(".controls_toggle").find("img").attr("src",Zd):f.find(".controls_toggle").find("img").attr("src",$d);da&&da.hasClass("play_link")&&nd.hasClass("hap_text_link")&&da.attr("src",od);ia&&ja&&(z.clearRect(0,0,K,Q),Xa(ka),Ya())}function y(a){return!isNaN(parseFloat(a))&&isFinite(a)}
function Jc(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)}function Lc(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)}function ya(a){if("string"===typeof a){if(qc&&l&&-1!=l.getCounter()){var b=l.getCounter();a=rc(u[b].id)+sc+a}}else{if("number"===typeof a){if(!l||0>a||a>w-1)return!1}else if(!l)return!1;b=l.getCounter();
a=fc(b)}hb&&Y?(Y.input(a),Y.activate()):Qa&&Qa.html(a)}function fc(a,b){if("undefined"===typeof b||null===b)b=!0;return u[a]&&u[a].title&&!C(u[a].title)?b?qc?rc(u[a].id)+sc+u[a].title:u[a].title:u[a].title:Gb}function rc(a){return 9>a?"0"+(a+1):a+1}function ae(a){var b=[],c=[],d=0;for(d;d<a;d++)b[d]=d;d=0;for(d;d<a;d++){var e=Math.round(Math.random()*(b.length-1));c[d]=b[e];b.splice(e,1)}return c}function be(a){var b=[],c=0;for(c;c<a;c++)b[c]=c;return b}function Md(a,b,c){"title"==b?a.sort(function(a,
b){return a.title==b.title?0:a.title<b.title?-1:1}):"type"==b&&a.sort(function(a,b){return a.type==b.type?0:a.type<b.type?-1:1});c&&a.reverse()}function C(a){return a?0==a.replace(/^\s+|\s+$/g,"").length:!0}function Ld(a){a=a.split(":");for(var b=0,c=1;0<a.length;)b+=c*parseInt(a.pop()),c*=60;return b}function Kd(a){if(window.ActiveXObject&&window.GetObject){var b=new ActiveXObject("Microsoft.XMLDOM");b.loadXML(a);return b}if(window.DOMParser)return(new DOMParser).parseFromString(a,"text/xml");throw Error("No XML parser available");
}function ce(a,b){return b-a}function Gd(a){if("string"===typeof a)switch(a.toLowerCase()){case "true":case "yes":case "1":return!0;case "false":case "no":case "0":case null:return!1;default:return!!a}else if("boolean"===typeof a)return!!a}function de(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}function ad(a){var b="",c="",d="",f,h,g;var m=a.type.toLowerCase();a.origtype&&(b=a.origtype.toLowerCase());if(a.mp3)var l=a.mp3;else a.path&&(l=a.path);a.title&&(c=
a.title);a.thumb&&(d=a.thumb);a.download&&(f=1==a.download?l:a.download);if(a.url)var n=a.url;a.dlink&&(h=1==a.dlink?l:a.dlink);"local"==m?"title"==xa?g="<li class= 'playlistItem' data-type='local' data-origtype='"+b+"' data-mp3='"+l+"' data-thumb='"+d+"' data-title='"+c+"'><a class='playlistNonSelected' href='#'>"+c+"</a></li>":"thumb"==xa?g="<li class= 'playlistItem' data-type='local' data-origtype='"+b+"' data-mp3='"+l+"' data-thumb='"+d+"' data-title='"+c+"'><a class='playlistNonSelected' href='#'><img src='"+
d+"' alt='thumb'/></a></li>":"all"==xa&&(g="<li class= 'playlistItem' data-type='local' data-origtype='"+b+"' data-mp3='"+l+"' data-thumb='"+d+"' data-title='"+c+"'><a class='playlistNonSelected' href='#'><span class='hap_thumb'><img src='"+d+"' alt='thumb'/></span><span class='hap_title'><p>'"+c+"'</p></span></a></li>"):(g="<li class= 'playlistItem' data-type='"+m+"' data-path='"+l+"' data-thumb='"+d+"'></li>","database_data"==m&&(l=a.table?a.table:null,b=a.limit?a.limit:null,a=a.range?a.range:null,
l&&(l=' data-table="'+l+'" ',c=g.match(/>/),g=g.slice(0,c.index)+l+g.slice(c.index)),b&&(l=' data-limit="'+b+'" ',c=g.match(/>/),g=g.slice(0,c.index)+l+g.slice(c.index)),a&&(l=' data-range="'+a+'" ',c=g.match(/>/),g=g.slice(0,c.index)+l+g.slice(c.index))));f&&(l=' data-download="'+f+'" ',c=g.match(/>/),g=g.slice(0,c.index)+l+g.slice(c.index));"local"==m?(h&&(l="<a class='dlink' href='#' data-dlink='"+h+"'><img src='"+tc+"' alt='download'/></a>",c=g.match(/<\/a><\/li>/),g=g.slice(0,c.index)+l+g.slice(c.index)),
n&&(l="<a class='plink' href='"+n+"' target='_blank'><img src='"+cd+"' alt='purchase'/></a>",c=g.match(/<\/a><\/li>/),g=g.slice(0,c.index)+l+g.slice(c.index))):(h&&(l=' data-dlink="'+h+'" ',c=g.match(/>/),g=g.slice(0,c.index)+l+g.slice(c.index)),n&&(l=' data-plink="'+n+'" ',c=g.match(/>/),g=g.slice(0,c.index)+l+g.slice(c.index)));m=document.createElement("ul");m.innerHTML=g;return e(m.firstChild)}function oc(a){a=e(a);a=e("<div>").append(a.clone()).html();var b=document.createElement("ul");b.innerHTML=
a;return e(b.firstChild)}function ib(a){w=u.length;if(0<w){Tb();var b=l.getCounter();a==b?(Rc(),l.setPlaylistItems(w)):(l.setPlaylistItems(w,!1),a<b&&l.reSetCounter(l.getCounter()-1));La&&ya()}else xb(),cb=null,"undefined"!==typeof playlistEmpty&&playlistEmpty(B,G)}var m=!1,B=this;e("body");var ed=e(window),qa=e(document);e.inArray(window.location.protocol,["http:","https:"]);var Cc,Nb="download"in document.createElement("a"),jb=navigator.userAgent,Xb;if(-1<jb.indexOf("iPhone")||-1<jb.indexOf("iPod")||
-1<jb.indexOf("iPad"))-1<jb.indexOf("iPhone")?Xb="iPhone":-1<jb.indexOf("iPod")?Xb="iPod":-1<jb.indexOf("iPad")&&(Xb="iPad");var td=-1<navigator.userAgent.toLowerCase().indexOf("safari/"),Dc=document.createElement("audio"),pd=!1;if(Dc.canPlayType){pd=!0;var zc=!!Dc.canPlayType&&""!=Dc.canPlayType("audio/mpeg")}var Dd=hap_source_path+g.buttonsUrl.prev,xd=hap_source_path+g.buttonsUrl.prevOn,Ed=hap_source_path+g.buttonsUrl.next,yd=hap_source_path+g.buttonsUrl.nextOn,Yd=hap_source_path+g.buttonsUrl.play,
Xd=hap_source_path+g.buttonsUrl.playOn,$d=hap_source_path+g.buttonsUrl.pause,Zd=hap_source_path+g.buttonsUrl.pauseOn,Ob=hap_source_path+g.buttonsUrl.loop,ub=hap_source_path+g.buttonsUrl.loopOn,Ec=hap_source_path+g.buttonsUrl.volume,zd=hap_source_path+g.buttonsUrl.volumeOn,Fc=hap_source_path+g.buttonsUrl.mute,Ad=hap_source_path+g.buttonsUrl.muteOn,Pb=hap_source_path+g.buttonsUrl.shuffle,vb=hap_source_path+g.buttonsUrl.shuffleOn,Fd=hap_source_path+g.buttonsUrl.download,Bd=hap_source_path+g.buttonsUrl.downloadOn,
cd=hap_source_path+g.buttonsUrl.trackUrlIcon,tc=hap_source_path+g.buttonsUrl.trackDownloadIcon,Nd=hap_source_path+g.buttonsUrl.trackRemoveIcon,od=hap_source_path+g.buttonsUrl.link_pause,Wb=hap_source_path+g.buttonsUrl.link_play,f=e(this).css("display","block"),ia=f.hasClass("hap_circle"),ja=!1;pd&&de()&&(ja=!0);var Xc="html5audio-popup"==f.attr("id"),Za=f.find(".playlistHolder"),na=f.find(".playlist_inner").css("opacity",0);f.find(".playerHolder");f.find(".player_mediaTime");var Na=f.find(".player_mediaTime_current"),
Oa=f.find(".player_mediaTime_total"),rd=f.find(".player_mediaName_Mask"),Qa=f.find(".player_mediaName");f.find(".player_controls");var ee=f.find(".player_volume"),md=f.find(".preloader"),Ia=f.find(".player_download");f.find(".componentPlaylist");var Ba=e(g.playlistList);Xc&&window.opener&&(Ba=window.opener.jQuery(g.playlistList));var G=g.sound_id,R=g.autoPlay,Wd=g.autoLoad;isMobile&&(R=!1,g.autoPlay=!1);var wc=g.soundcloudApiKey,X=g.soundcloud_result_limit,nc=g.podcast_result_limit,hb=g.useSongNameScroll,
La=g.autoSetSongTitle,Z=g.loopingOn,aa=g.randomPlay,Vb=g.mediaTimeSeparator,Kc=g.seekTooltipSeparator,Gb=g.defaultArtistData,qc=g.useNumbersInPlaylist,sc=g.titleSeparator,cb=g.activePlaylist,r=g.useAlertMessaging,fd=g.activatePlaylistScroll,sb=g.playlistScrollOrientation.toLowerCase(),Pd=g.sortablePlaylistItems,Qd=g.autoReuseMailForDownload,dd=g.useRemoveBtnInTracks,fe=g.useVolumeTooltip,ge=g.useSeekbarTooltip,xa=g.playlistItemContent.toLowerCase(),he=g.useKeyboardNavigation,ie=g.useBtnRollovers,
Tc=g.usePlaylistRollovers,Zc=g.getTrackInfoFromID3;Na.html("0:00");Oa.html("0:00");var Ac=Na.html(),Bc=Oa.html();Qa.html(Gb);Na.html(Ac+Vb);Oa.html(Bc);var Ca,Ja,ba,Ab,bb,ab,W=!1,mc,pa,hd,vc,ua,L,T,zb,S,Db,nd,da,Cb,jc,pc=!1;void 0!=Za.attr("data-playlistLocked")&&(pc=!0);var yb=!1,Eb,q,n=null,p=!0,Gc=!1,ic=!1,fb,Rb,$a,U=!1,Pa="",A=!1,Jd=hap_source_path+"includes/ba-simple-proxy.php",wa,Ma;Z&&f.find(".player_loop").find("img").attr("src",ub);aa&&f.find(".player_shuffle").find("img").attr("src",vb);
var u=[],va=[],D=[],w=0,F,Vc,Yc=e('<div class="hap_feedParser"/>'),Rd=0==f.find("iframe[id='dl_iframe']").length?e('<iframe id="dl_iframe"/>').css({position:"absolute",left:"-10000px",display:"none"}).appendTo(f):f.find("iframe[id='dl_iframe']"),db=e("<div/>"),lc=e("<div/>");if(isMobile)var Fb,Sd=1E3,Ub=0==Za.find("div[id='download_confirm']").length?e('<div id="download_confirm"><p>DOWNLOAD STARTING</p></DIV>').css({opacity:0,zIndex:1E3}).appendTo(Za):Za.find("div[id='download_confirm']");var t=
[],x=[],ld=!1,Bb,h,Qb;window.Hls&&(Qb=Hls.isSupported());var Y;hb&&d();var l=e.playlistManager({randomPlay:aa,loopingOn:Z});e(l).on("ap_PlaylistManager.COUNTER_READY",function(){var a=l.getCounter(),b=u[a];b&&!pc&&(Qc(),La&&ya(),$a=b.origtype?b.origtype:b.type,Pa=b.mp3,b.download?zb=!0:zb=null,Nb&&zb&&(Ia.find("a.hap-download").length?Ia.find("a.hap-download").attr("href",b.download):(b=e('<a class="hap-download" href="'+b.download+'" download></a>'),Ia.off("click").wrapInner(b))),wb(),yc(),"undefined"!==
typeof itemTriggered&&itemTriggered(B,G,a))});e(l).on("ap_PlaylistManager.PLAYLIST_END",function(){Qc();"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(B,G);A=!1;ta("off")});e(l).on("ap_PlaylistManager.PLAYLIST_END_ALERT",function(){"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(B,G)});var eb="",Ra="",Sa="";if("ontouchstart"in window){var uc=!0;eb="touchstart.ap mousedown.ap";Ra="touchmove.ap mousemove.ap";Sa="touchend.ap mouseup.ap"}else uc=!1,eb="mousedown.ap",
Ra="mousemove.ap",Sa="mouseup.ap";var ob=!1,Yb,Hb=!1,v=g.defaultVolume;0>v&&(v=0);0==v?Yb=.5:1<v&&(v=1);var N=f.find(".volume_seekbar").css("cursor","pointer").on(eb,function(a){a.preventDefault();Ea(a);return Hb=!1}),nb="horizontal";void 0!=N.attr("data-orientation")&&(nb=N.attr("data-orientation").toLowerCase());if(void 0!=N.attr("data-autoHide")){ob=!0;var lb=!1,E,Jb=parseInt(N.attr("data-autoHide"),10);if(!isMobile)ee.on("mouseover",function(){if(!m)return!1;E&&clearTimeout(E);N.css("display",
"block");lb=!0;return!1}).on("mouseout",function(){if(!m)return!1;E&&clearTimeout(E);E=setTimeout(M,Jb);return!1})}var mb=!1,O=0,Ib=f.find(".volume_level"),Ta=f.find(".volume_bg");if(fe&&!isMobile){N.on("mouseover",ra);var ha=f.find(".player_volume_tooltip"),sd=parseInt(ha.css("top"),10);ha.on("mouseenter",function(){N.off("mouseover",ra);ha.css("display","none")}).on("mouseleave",function(){N.on("mouseover",ra)})}else f.find(".player_volume_tooltip").remove();var Fa,qb,ea=!1,Kb=f.find(".progress_bg"),
gb=f.find(".load_progress"),Ga=f.find(".play_progress"),za=f.find(".player_progress"),V=Kb.width();if(ia){var kb=f.find(".load_canvas").css("cursor","pointer"),qd=f.find(".play_canvas"),la=f.find(".circlePlayer");parseFloat(la.attr("data-offOpacity"),10);parseFloat(la.attr("data-onOpacity"),10);var je=parseInt(la.attr("data-strokeSize"),10),ke=qd.attr("data-bgcolor"),le=kb.attr("data-bgcolor");parseInt(la.attr("data-tolerance"),10);var me=kb.width(),ne=kb.height();if(ja){var rb=je,cc=ke,Vd=le,z=kb[0].getContext("2d"),
Da=qd[0].getContext("2d"),Mc=2*Math.PI,Mb=Math.PI/2,K=me,Q=ne,bc=K/2,ac=bc-rb,Hc=g.tolerance,$b,Lb=!1,ka=0;kb.on(eb,function(a){a.preventDefault();Zb(a)?(Lb=!1,$b>ac-Hc||ea||(pb(!0),z.clearRect(0,0,K,Q),Xa(ka),Ya())):(Lb=!0,Va(a));return!1});za=kb}}else za=f.find(".player_progress").css("cursor","pointer").on(eb,function(a){Va(a);return!1});if(ge&&!isMobile){za.on("mouseover",sa);var ma=f.find(".player_progress_tooltip").css("zIndex",50);ma.find("p").html("0:00"+Kc+"0:00");ma.on("mouseenter",function(){za.off("mouseover",
sa);ma.css("display","none")}).on("mouseleave",function(){za.on("mouseover",sa)})}else f.find(".player_progress_tooltip").remove();if(Qb){var Aa=new Hls;Aa.on(Hls.Events.MEDIA_ATTACHED,function(){Aa.loadSource(Pa)});Aa.on(Hls.Events.ERROR,function(a,b){if(b.fatal)switch(b.type){case Hls.ErrorTypes.NETWORK_ERROR:console.log("fatal network error encountered, try to recover");Aa.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover");Aa.recoverMediaError();
break;default:Aa.destroy()}})}he&&qa.keyup(function(a){if(!m||p)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=a.keyCode;37==a?B.previousAudio():39==a?B.nextAudio():32==a?B.toggleAudio():77==a&&(H(),fa());return!1});ed.resize(function(){if(!m||p)return!1;Cc&&clearTimeout(Cc);Cc=setTimeout(gd,150)});this.getCurrentTime=function(){if(!m||!$a)return!1;if(h)var a=h.currentTime;return a};this.setPlayIcon=function(){da&&da.hasClass("play_link")&&da.attr("src",
Wb);A=!1};this.playAudio=function(){if(!m||p||!n||A||!U)return!1;h&&h.play();tb("off");U=A=!0};this.pauseAudio=function(){if(!m||p||!n||!A||!U)return!1;h&&h.pause();ta("off");A=!1};this.toggleAudio=function(){if(!m||p||!n||!U)return!1;pb()};this.stopAudio=function(){if(!m||p||!n||!U)return!1;h&&(h.src="",zc&&(h.src=Pa));hc();A=!1};this.checkAudio=function(a){if(!m||p)return!1;a=a.toLowerCase();A&&("pause"==a?h&&h.pause():"stop"==a&&(h&&(h.src="",zc&&(h.src=Pa)),hc()),A=!1,ta("off"))};this.nextAudio=
function(){if(!m||p||!n)return!1;oa();l.advanceHandler(1,!0)};this.previousAudio=function(){if(!m||p||!n)return!1;oa();l.advanceHandler(-1,!0)};this.loadAudio=function(a){if(!m||p||!n)return!1;if("string"===typeof a){var b=0,c=!1;for(b;b<w;b++)if(a==u[b].title){a=b;c=!0;break}if(!c)return r&&alert('Track with name "'+a+'" doesnt exist. Load audio failed.'),!1}else if("number"===typeof a){if(0>a||a>w-1)return r&&alert('Invalid track number. Track number  "'+a+'" doesnt exist. Load audio failed.'),
!1}else return r&&alert("Load audio method requires either a track number or a track title to load. Load audio failed."),!1;oa();l.processPlaylistRequest(a)};this.loadPlaylist=function(a){if(!m||p)return!1;if("undefined"===typeof a)return r&&alert("loadPlaylist method requires data parameter. loadPlaylist failed."),!1;cb=a;Uc(cb)};this.addTrack=function(a,b,c,d){if(!m||p)return!1;if("undefined"===typeof a)return r&&alert("addTrack method requires type parameter. AddTrack failed."),!1;if("undefined"===
typeof b)return r&&alert("addTrack method requires format parameter. AddTrack failed."),!1;if("undefined"===typeof c)return r&&alert("addTrack method requires track parameter. AddTrack failed."),!1;var f=1,g=!1;if("string"!==typeof c&&"[object Object]"!==Object.prototype.toString.call(c))if("[object Array]"===Object.prototype.toString.call(c))f=c.length,g=!0;else return r&&alert("addTrack method requires track as string, object or array parameter. AddTrack failed."),!1;ba=d;a=a.toLowerCase();"visible"==
a?(n&&W&&xb(),Ab=!0,W=!1):(n&&!W&&xb(),W=bb=!0);Ja=!1;if(n)if("undefined"!==typeof ba){if(0>ba||ba>w)return r&&alert('Invalid position to insert track to. Position number "'+d+'" doesnt exist. AddTrack failed.'),!1;ba==w&&(Ja=!0)}else Ja=!0,ba=w;else{if("undefined"!==typeof ba){if(0!=ba)return r&&alert('Invalid position to insert track to. Position number "'+d+'" doesnt exist. AddTrack failed.'),!1}else ba=0;Ja=!0}Wc();p=!0;yb=!1;d=0;var h=e("<ul id = playlist"+Math.floor(9999*Math.random())+"></ul>");
b=b.toLowerCase();for(d;d<f;d++){var k=g?c[d]:c;"html"==b?oc(k).appendTo(h):(k.type&&k.mp3||k.path)&&ad(k).appendTo(h)}x=[];db.empty();h.appendTo(db).find("li[class='playlistItem']").each(function(){x.push(e(this))});ab=!1;n||(ab=!0,n="visible"==a?na:lc);I()};this.inputAudio=function(a){if(!m||p)return!1;if("undefined"===typeof a)return r&&alert("inputAudio method requires data parameter. inputAudio failed."),!1;if("undefined"===a.mp3)return r&&alert("inputAudio method requires data.mp3 parameter. inputAudio failed."),
!1;oa();l.reSetCounter();Pa=a.mp3;"undefined"!==a.title?ya(a.title):ya(Gb);isMobile&&(R=!0);wb();yc()};this.removeTrack=function(a){if(!m||p||!n)return!1;if("undefined"===typeof a)return r&&alert("removeTrack method requires track parameter. removeTrack failed."),!1;if("string"===typeof a){var b=0,c=!1;for(b;b<w;b++)if(a==u[b].title){a=b;c=!0;break}if(!c)return r&&alert('Track with name "'+a+'" doesnt exist. RemoveTrack failed.'),!1;D[a]&&u[a]?(D[a].remove(),u.splice(a,1),ib(a)):r&&alert('RemoveTrack with name "'+
a+'" failed.')}else if("number"===typeof a){if(0>a||a>w-1)return r&&alert('Invalid track number. Track number  "'+a+'" doesnt exist. RemoveTrack failed.'),!1;D[a]&&u[a]?(D[a].remove(),u.splice(a,1),ib(a)):r&&alert('RemoveTrack with name "'+a+'" failed.')}else if("[object Array]"===Object.prototype.toString.call(a))if("string"===typeof a[0]?b=!0:"number"===typeof a[0]&&(b=!1),b)a:for(b=0,c=a.length,b;b<c;b++){var d=a[b];if("string"===typeof d){var e=0;var f=u.length;if(0==f){ib();break a}for(e;e<f;e++)if(d==
u[e].title&&D[e]&&u[e]){D[e].remove();u.splice(e,1);ib(e);break}}}else a:for(a.sort(ce),b=0,c=a.length,b;b<c;b++){if(d=a[b],"number"===typeof d){f=u.length;if(0==f){ib();break a}-1<d&&d<f&&D[d]&&u[d]&&(D[d].remove(),u.splice(d,1),ib(d))}}else return r&&alert("removeTrack method requires track parameter as string, number or array. removeTrack failed."),!1};this.destroyAudio=function(){if(!m||p||!n)return!1;Rc()};this.destroyPlaylist=function(){if(!m||p||!n)return!1;xb()};this.setTitle=function(a){if(!m||
p||!n)return!1;ya(a)};this.toggleShuffle=function(){if(!m||p)return!1;aa?(f.find(".player_shuffle").find("img").attr("src",Pb),aa=!1):(f.find(".player_shuffle").find("img").attr("src",vb),aa=!0);l.setRandom(aa)};this.toggleLoop=function(){if(!m||p)return!1;Z?(f.find(".player_loop").find("img").attr("src",Ob),Z=!1):(f.find(".player_loop").find("img").attr("src",ub),Z=!0);l.setLooping(Z)};this.setVolume=function(a){if(!m||p)return!1;0>a?a=0:1<a&&(a=1);v=a;fa()};this.getVolume=function(){return m?v:
!1};this.setAutoPlay=function(a){if(!m)return!1;R=a};this.getAutoPlay=function(){return m?R:!1};this.getIsMobile=function(){return isMobile};this.getMobileType=function(){return Xb};this.getSetupDone=function(){return m};this.getPlaylistLoaded=function(){return yb};this.getPlaylistTransition=function(){return p};this.getMediaPlaying=function(){return!m||p?!1:A};this.getAudioInited=function(){return!m||p?!1:U};this.getMediaType=function(){return!m||p?!1:$a};this.getActiveItem=function(){return!m||
p?!1:l.getCounter()};this.getPlaylistItems=function(a){if(!m||p||!D||0==D.length)return!1;if("string"===typeof a)return D;if("number"===typeof a)return 0>num||num>w-1||!D[num]?!1:D[num]};this.getMediaCount=function(){return!m||p?!1:y(w)?w:0};this.getPlaylistHidden=function(){return!m||p?!1:W};this.get_hidden_playlist_holder=function(){return m?lc:!1};this.getPlaylistList=function(){return m&&Ba&&0!=Ba.length?Ba:!1};this.orderPlaylist=function(a,b){if(!m||!n)return!1;if("undefined"===typeof a)return r&&
alert("orderPlaylist method requires action parameter. orderPlaylist failed."),!1;var c=n.children("li"),d=c.length;if(0==d)return!1;var f=a.toLowerCase();if("reverse"==f)n.append(c.get().reverse());else if("random"==f||"remap"==f||"swap"==f){if("random"==f)b=ae(d);else if("remap"==f){if("undefined"===typeof b||b.length!=d)return!1}else if("swap"==f){if("undefined"===typeof b||2!=b.length)return!1;c=be(d);c.splice(b[1],1,b[0]);c.splice(b[0],1,b[1]);b=e.extend(!0,[],c)}else return!1;orderedItems=jQuery.map(b,
function(a){return jQuery(D).get(a)});n.empty().html(orderedItems)}else return r&&alert("Wrong action parameter for orderPlaylist method. orderPlaylist failed."),!1;Tb();if(c=na.find("a[class=playlistSelected]").attr("data-id"))l.reSetCounter(c),La&&ya()};this.checkScroll=function(){if(!m||p||!n)return!1;ec()};this.reinitScroll=function(){if(!m||p||!n)return!1;F&&(F.reinitialise(),"vertical"==sb?(F.scrollToY(0),e(".jspPane").css("top","0px")):(F.scrollToX(0),e(".jspPane").css("left","0px")));hb&&
Y&&l&&-1!=l.getCounter()&&La&&ya()};this.getPlaylistData=function(){return m&&!p&&n?u:!1};this.getSoundId=function(){return m?G:!1};this.getTouch=function(){return m?uc:!1};this.get_hap_source_path=function(){return m?hap_source_path:!1};(function(){var a=[f.find(".controls_next"),f.find(".controls_prev"),f.find(".controls_toggle"),f.find(".player_volume"),f.find(".player_download"),f.find(".player_loop"),f.find(".player_shuffle")],b=a.length,c=0;for(c;c<b;c++){var d=e(a[c]).css("cursor","pointer").on("click",
vd);if(ie&&!isMobile)d.on("mouseover",wd).on("mouseout",Cd)}})();(function(){f.find(".hap_text_link").each(function(){var a=e(this),b=a.attr("href");"undefined"!==typeof b&&!1!==b&&a.prepend('<img class="play_link" src="'+Wb+'"/>')});f.find(".hap_text_link, .hap_image_link").click(function(a){if(!m||p)return!1;a=e(this);var b=a.attr("href");if("undefined"===typeof b||!1===b)return!1;if(Cb&&Cb==b)return pb();oa();l.reSetCounter();Cb=b;nd=a;jc=!0;da&&da.attr("src",Wb);a.hasClass("hap_text_link")&&(da=
a.find("img").attr("src",od));Pa=Cb;R=!0;wb();yc();return jc=!1})})();cb?Uc(cb):m||bd();return this}})(jQuery);
(function(e){function g(d){this._loopingOn=d.loopingOn;this._randomPlay=d.randomPlay;this._playlistItems;this._lastInOrder=!1;this._counter=-1;this._lastPlayedFromPlaylistClick;this._lastRandomCounter;this._randomPaused=!1;this._randomArr=[];this._playlistSelect=!1}e.playlistManager=function(d){return new g(d)};g.prototype={setCounter:function(d,e){"undefined"===typeof e&&(e=!0);this._counter=e?this._counter+parseInt(d,10):parseInt(d,10);this._checkCounter()},getCounter:function(){return this._randomPlay?
this._playlistSelect?this._counter:this._randomArr[this._counter]:this._counter},advanceHandler:function(d){this._playlistSelect=!1;this._randomPaused?this._handleRandomPaused(d):this.setCounter(d)},processPlaylistRequest:function(d){this._playlistSelect=!1;this._randomPlay&&(this._playlistSelect=!0,this._lastPlayedFromPlaylistClick=d,this._randomPaused||(this._lastRandomCounter=this._counter,this._randomPaused=!0));this.setCounter(d,!1)},getLastInOrder:function(){return this._lastInOrder},getRandomPaused:function(){return this._randomPaused},
setPlaylistItems:function(d,e){"undefined"===typeof e&&(e=!0);e&&(this._counter=-1);this._playlistItems=d;this._randomPlay&&this._makeRandomList()},reSetCounter:function(d){"undefined"===typeof d?this._counter=-1:(d=parseInt(d,10),this._playlistItems?(d>this._playlistItems-1?d=this._playlistItems-1:0>d&&(d=0),this._counter=d):this._counter=-1)},setRandom:function(d){(this._randomPlay=d)&&this._makeRandomList();this._randomChange()},setLooping:function(d){this._loopingOn=d},_handleRandomPaused:function(d){var g=
e(this);this._randomPaused=!1;this._lastRandomCounter+d>this._playlistItems-1?(this._counter=this._playlistItems-1,g.trigger("ap_PlaylistManager.COUNTER_READY")):0>this._lastRandomCounter+d?(this._counter=0,g.trigger("ap_PlaylistManager.COUNTER_READY")):this.setCounter(this._lastRandomCounter+d,!1)},_randomChange:function(){this._randomPlay?(this._activeIndexFirst(),this._counter=0):this._randomPaused?(this._counter=this._lastPlayedFromPlaylistClick,this._randomPaused=!1):this._counter=this._randomArr[this._counter]},
_checkCounter:function(){if(isNaN(this._counter))alert("ap_PlaylistManager message: No active media, counter = "+this._counter);else{var d=e(this);this._lastInOrder=!1;this._loopingOn?(this._randomPlay?this._counter>this._playlistItems-1?(this._counter=this._randomArr[this._playlistItems-1],this._makeRandomList(),this._firstIndexCheck(),this._counter=0,d.trigger("ap_PlaylistManager.PLAYLIST_END")):0>this._counter&&(this._counter=this._randomArr[0],this._makeRandomList(),this._lastIndexCheck(),this._counter=
this._playlistItems-1):this._counter>this._playlistItems-1?(this._counter=0,d.trigger("ap_PlaylistManager.PLAYLIST_END")):0>this._counter&&(this._counter=this._playlistItems-1),d.trigger("ap_PlaylistManager.COUNTER_READY")):(this._counter>this._playlistItems-1?(this._counter=this._playlistItems-1,this._lastInOrder=!0):0>this._counter&&(this._counter=0),this._lastInOrder?d.trigger("ap_PlaylistManager.PLAYLIST_END"):d.trigger("ap_PlaylistManager.COUNTER_READY"))}},_makeRandomList:function(){3>this._playlistItems||
(this._randomArr=this._randomiseIndex(this._playlistItems))},_firstIndexCheck:function(){if(this._randomArr[0]==this._counter){var d=this._randomArr.splice(0,1);this._randomArr.push(d)}},_lastIndexCheck:function(){if(this._randomArr[this._playlistItems-1]==this._counter){var d=this._randomArr.splice(this._playlistItems-1,1);this._randomArr.unshift(d)}},_activeIndexFirst:function(){var d,e=this._randomArr.length;for(d=0;d<e;d++)if(this._randomArr[d]==this._counter){if(0==d)break;d=this._randomArr.splice(d,
1);this._randomArr.unshift(parseInt(d,10));break}},_randomiseIndex:function(d){var e=[],g=[],J;for(J=0;J<d;J++)e[J]=J;for(J=0;J<d;J++){var H=Math.round(Math.random()*(e.length-1));g[J]=e[H];e.splice(H,1)}return g}}})(jQuery);
(function(e){apTextScroller=function(){function e(){"left"==fa&&(P-=M,d.css("left",P+"px"),parseInt(d.css("left"),10)<-H&&(P=-M))}var d,M,Ea,J,H,fa,ra,P=0,Ua,Va,Wa,sa,Ha=!1;this.init=function(e,g,H,P,ra,sa){Ua=e;d=g;Ea=H;fa=P;J=ra;M=sa};this.input=function(e){Va=e;Ua.html(e);Wa=Ua.width();var g=e.replace(/\s/g,"&nbsp;")+J;d.html("");d.css("width","auto");d.html(g);H=d.width();if(0!=H){e=g;if(H<=2*Ea.width()){for(var M=Math.floor(2*Ea.width()/H),P=0;P<M;P++)e+=g;g=H*(M+1)}else e+=g,g=2*H;d.html(e);
d.css("width",g+1+"px");sa=e;Ha=!0}};this.inputSingle=function(d){};this.activate=function(){this.deactivate();Ea.width()>=Wa?d.html(Va):(d.html(sa),ra=setInterval(e,100))};this.deactivate=function(){ra&&clearInterval(ra);"left"==fa&&(d.css("left","0px"),P=0)};this.checkSize=function(){Ha&&(Ea.width()>=Wa?(this.deactivate(),d.html(Va)):(d.html(sa),this.activate()))}}})(jQuery); 