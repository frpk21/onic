<script src="https://unpkg.com/wavesurfer.js@7"></script>

{% extends 'base/base.html' %}

{% load static %}

{% block contenido %}

<section class="page-header" style="background-image: url({{subcategoria.imagen.url}});">
    <div class="container">
        <h2>Multimedia</h2>
    </div>
</section>
<section class="collection-grid collection-masonary">
    <div class="container">
        <div class="collection-grid__top">
            <div class="block-title text-left">
                <p>Galer&iacute;a</p>
                <h3>Explore <br> Nuestro Contenido</h3>
            </div>
            <ul class="collection-filter post-filter list-unstyled">
                <li data-filter=".filter-item" class="active"><span>Todo</span></li>
                <li data-filter=".pic"><span>Im&aacute;genes</span></li>
                <li data-filter=".dis"><span>V&iacute;deos</span></li>
                <li data-filter=".poster"><span>Podcast</span></li>
            </ul>
        </div>
        <div class="row high-gutter filter-layout masonary-layout">
            {% for item in catastro %}
                <div class="col-lg-4 col-md-6 filter-item masonary-item pic">
                    <div class="collection-grid__single">
                        <div class="collection-grid__image">
                            <img src="{{item.imagen.url}}" alt="">
                            <a href="{% url 'generales:detalle' item.slug %}" class="collection-grid__link">+</a>
                        </div>
                        <div class="collection-grid__content">
                            <h3><a href="{% url 'generales:detalle' item.slug %}">{{item.titulo}}</a></h3>
                            <p>{{item.fuente}}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}
            {% for item in censo %}
                <div class="col-lg-4 col-md-6 filter-item masonary-item dis">
                    <div class="collection-grid__single">
                        <div class="collection-grid__image">
                            <img src="{{item.imagen.url}}" alt="">
                            <a href="{% url 'generales:detalle' item.slug %}" class="collection-grid__link">+</a>
                        </div>
                        <div class="collection-grid__content">
                            <h3><a href="{% url 'generales:detalle' item.slug %}">{{item.titulo}}</a></h3>
                            <p>{{item.fuente}}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}
            <div class="col-lg-4 col-md-6 filter-item masonary-item poster">
                {% for item in podcast %}
                    {{item.titulo}}-<div id="id_audio{{forloop.counter}}">{{item.archivo_audio.url}}</div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<script>
    import WaveSurfer from 'wavesurfer.js'
    //var audio_file = document.getElementById('id_audio').value;
// Create your own media element
const audio = new Audio()
audio.controls = true
audio.src = '/examples/audio/audio.wav'

// Create a WaveSurfer instance and pass the media element
const wavesurfer = WaveSurfer.create({
  container: document.body,
  waveColor: 'rgb(200, 0, 200)',
  progressColor: 'rgb(100, 0, 100)',
  media: audio, // <- this is the important part
})

// Optionally, add the audio to the page to see the controls
document.body.appendChild(audio)

// Now, create a Web Audio equalizer

// Create Web Audio context
const audioContext = new AudioContext()

// Define the equalizer bands
const eqBands = [32, 64, 125, 250, 500, 1000, 2000, 4000, 8000, 16000]

// Create a biquad filter for each band
const filters = eqBands.map((band) => {
  const filter = audioContext.createBiquadFilter()
  filter.type = band <= 32 ? 'lowshelf' : band >= 16000 ? 'highshelf' : 'peaking'
  filter.gain.value = Math.random() * 40 - 20
  filter.Q.value = 1 // resonance
  filter.frequency.value = band // the cut-off frequency
  return filter
})

// Connect the audio to the equalizer
audio.addEventListener(
  'canplay',
  () => {
    // Create a MediaElementSourceNode from the audio element
    const mediaNode = audioContext.createMediaElementSource(audio)

    // Connect the filters and media node sequentially
    const equalizer = filters.reduce((prev, curr) => {
      prev.connect(curr)
      return curr
    }, mediaNode)

    // Connect the filters to the audio output
    equalizer.connect(audioContext.destination)
  },
  { once: true },
)

// Create a vertical slider for each band
const container = document.createElement('p')
filters.forEach((filter) => {
  const slider = document.createElement('input')
  slider.type = 'range'
  slider.orient = 'vertical'
  slider.style.appearance = 'slider-vertical'
  slider.style.width = '8%'
  slider.min = -40
  slider.max = 40
  slider.value = filter.gain.value
  slider.step = 0.1
  slider.oninput = (e) => (filter.gain.value = e.target.value)
  container.appendChild(slider)
})
document.body.appendChild(container)

</script>

{% endblock contenido %}
